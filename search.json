[{"path":"https://niaid.github.io/HDStIM/articles/HDStIM.html","id":"example","dir":"Articles","previous_headings":"","what":"Example","title":"HDStIM","text":"example using sample CyTOF data set chi11 included package. suppressMessages() used reduce verbosity HDStIM function.","code":"library(HDStIM) suppressMessages(library(dplyr)) suppressMessages(library(tibble))  mapped_data <-  HDStIM(chi11$expr_data, chi11$state_markers,                   chi11$cluster_col, chi11$stim_label,                   chi11$unstim_label, seed_val = 123, umap = TRUE, umap_cells = 500, verbose = FALSE)  class(mapped_data) #> [1] \"list\"  attributes(mapped_data) #> $names #>  [1] \"response_mapping_main\" \"stacked_bar_plot_data\" \"state_markers\"         #>  [4] \"cellpop_col\"           \"stim_label\"            \"unstim_label\"          #>  [7] \"seed_val\"              \"all_fisher_p_val\"      \"all_k_means_data\"      #> [10] \"umap_plot_data\"        \"umap\"                  \"umap_cells\""},{"path":"https://niaid.github.io/HDStIM/articles/HDStIM.html","id":"output","dir":"Articles","previous_headings":"Example","what":"Output","title":"HDStIM","text":"HDStIM() returns list mapped expression data, data plot stacked bar plots visualize k-means Fisher’s exact test results data plot optional UMAPs.","code":"head(mapped_data$response_mapping_main) #> # A tibble: 6 × 41 #>   cluster_id sample_id      condition patient_id stim_type cell_population  CD45 #>        <dbl> <chr>          <chr>     <chr>      <chr>     <chr>           <dbl> #> 1         79 CHI-011_1_2_G  CHI       CHI-011    G         CD11c CD14 CD38  3.48 #> 2         69 CHI-011_2_4_G  CHI       CHI-011    G         CD11c CD14 CD38  2.22 #> 3         69 CHI-011_4_13_G CHI       CHI-011    G         CD11c CD14 CD38  3.03 #> 4         79 CHI-011_4_11_G CHI       CHI-011    G         CD11c CD14 CD38  2.82 #> 5         69 CHI-011_2_5_G  CHI       CHI-011    G         CD11c CD14 CD38  2.07 #> 6         69 CHI-011_1_1_G  CHI       CHI-011    G         CD11c CD14 CD38  3.39 #> # … with 34 more variables: CD7 <dbl>, CD19 <dbl>, pPLCg2 <dbl>, CD4 <dbl>, #> #   IgD <dbl>, CD20 <dbl>, CD25 <dbl>, pSTAT5 <dbl>, CD123 <dbl>, AKT <dbl>, #> #   pSTAT1 <dbl>, CD27 <dbl>, pP38 <dbl>, CD24 <dbl>, pSTAT3 <dbl>, #> #   CD11c <dbl>, CD14 <dbl>, CD56 <dbl>, IkBa <dbl>, pCREB <dbl>, CD16 <dbl>, #> #   CD38 <dbl>, CD8 <dbl>, CD45RA <dbl>, CD3 <dbl>, pERK1_2 <dbl>, #> #   HLA_DR <dbl>, pS6 <dbl>, CD127 <dbl>, ncount <int>, k_cluster_id <int>, #> #   responding_cluster <int>, response_status <chr>, comb_no <int> head(mapped_data$stacked_bar_plot_data) #> # A tibble: 6 × 7 #>   cell_population            stim_type  f_p_val stim_clust stim_status k_cluster #>   <chr>                      <chr>        <dbl>      <dbl> <chr>       <chr>     #> 1 CD11c CD14 CD38            A         3.05e-26          1 unstim      cluster1  #> 2 CD11c CD14 CD38            A         3.05e-26          1 unstim      cluster2  #> 3 CD11c CD14 CD38            A         3.05e-26          1 stim        cluster1  #> 4 CD11c CD14 CD38            A         3.05e-26          1 stim        cluster2  #> 5 CD19 CD20 CD45RA HLA-DR C… A         5.56e-18          2 unstim      cluster1  #> 6 CD19 CD20 CD45RA HLA-DR C… A         5.56e-18          2 unstim      cluster2  #> # … with 1 more variable: cell_count_perc <dbl> head(mapped_data$umap_plot_data) #> # A tibble: 6 × 8 #>   cell_population stim_type condition tot_of_cells no_of_cells  UMAP1   UMAP2 #>   <chr>           <chr>     <chr>     <chr>        <chr>        <dbl>   <dbl> #> 1 CD11c CD14 CD38 A         CHI       200          200          1.00   0.0315 #> 2 CD11c CD14 CD38 A         CHI       200          200          1.58  -1.43   #> 3 CD11c CD14 CD38 A         CHI       200          200         -1.76   1.43   #> 4 CD11c CD14 CD38 A         CHI       200          200          0.823 -0.670  #> 5 CD11c CD14 CD38 A         CHI       200          200          0.958 -1.07   #> 6 CD11c CD14 CD38 A         CHI       200          200         -1.15  -0.482  #> # … with 1 more variable: response_status <chr>"},{"path":[]},{"path":"https://niaid.github.io/HDStIM/articles/HDStIM.html","id":"plots-explaining-k-means-clustering-fishers-exact-test-and-fold-change","dir":"Articles","previous_headings":"Example > Figures","what":"Plots Explaining k-means Clustering, Fisher’s Exact Test, and Fold Change","title":"HDStIM","text":"Using stacked_bar_plot_data, bar plots can plotted shows given cluster stimulation type percentage cells stimulated unstimulated samples clustered two k-means clusters. stacked_bar_plot_data returned combinations pass Fisher’s exact test k-means clustering. combination plot data also contains p-value Fisher’s exact test fold change cells stimulated samples responded. can either use function plot_K_Fisher provided package plot combinations cluster stimulation types specified folder like use backend code plot combinations interest custom aesthetics. code plots first combination.","code":"plot_K_Fisher(mapped_data, path, verbose = FALSE)"},{"path":"https://niaid.github.io/HDStIM/articles/HDStIM.html","id":"umap-plots-to-visually-inspect-responding-and-non-responding-cell-selection","dir":"Articles","previous_headings":"Example > Figures","what":"UMAP Plots to Visually Inspect Responding and Non-Responding Cell Selection","title":"HDStIM","text":"Note: can generate plot asked UMAPs calcualted HDStIM() function. UMAP plots can useful visually inspecting well selection method separated responding non-responding cells cluster stimulation type combination. plots shows cells unstimulated samples fell unstim cluster responding non-responding cells stimulated samples fell stim unstim clusters respectively. can either use function plot_umap provided package plot combinations cluster stimulation types specified folder like use backend code plot combinations interest custom aesthetics. code plots UMAP first combination using output .","code":"plot_umap(mapped_data, path, verbose = FALSE)"},{"path":"https://niaid.github.io/HDStIM/articles/HDStIM.html","id":"distribution-plots-for-individual-state-marker-before-and-after-selection","dir":"Articles","previous_headings":"Example > Figures","what":"Distribution plots for Individual State Marker before and after Selection","title":"HDStIM","text":"can either use function plot_exprs provided package plot combinations cluster stimulation types specified folder like use backend code plot combinations interest custom aesthetics. code plots distribution plot first combination using output .","code":"plot_exprs(original_data, mapped_data, path,verbose = FALSE)"},{"path":"https://niaid.github.io/HDStIM/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Rohit Farmer. Author, maintainer. Richard Apps. Author. John Tsang. Project director.","code":""},{"path":"https://niaid.github.io/HDStIM/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Farmer R, Apps R (2022). HDStIM: High Dimensional Stimulation Immune Mapping (HDStIM). https://github.com/niaid/HDStIM, https://niaid.github.io/HDStIM/.","code":"@Manual{,   title = {HDStIM: High Dimensional Stimulation Immune Mapping (HDStIM)},   author = {Rohit Farmer and Richard Apps},   year = {2022},   note = {https://github.com/niaid/HDStIM, https://niaid.github.io/HDStIM/}, }"},{"path":[]},{"path":"https://niaid.github.io/HDStIM/comments.html","id":"main-hdstim-function","dir":"","previous_headings":"","what":"Main HDStIM Function","title":"For Building and Testing","text":"mapped_data <- HDStIM(chi11exprdata, chi11state_markers, chi11clustercol, chi11stim_label, chi11$unstim_label, seed_val = 123, umap = FALSE, umap_cells = NULL, verbose = FALSE)","code":""},{"path":"https://niaid.github.io/HDStIM/comments.html","id":"pkgdown-website","dir":"","previous_headings":"","what":"Pkgdown Website","title":"For Building and Testing","text":"pkgdown::build_site_github_pages()","code":""},{"path":"https://niaid.github.io/HDStIM/index.html","id":"hdstim-","dir":"","previous_headings":"","what":"High Dimensional Stimulation Immune Mapping (HDStIM)","title":"High Dimensional Stimulation Immune Mapping (HDStIM)","text":"goal package identify response stimulant CyTOF/Flow cytometry stimulation assays labeling cells responded based unsupervised high dimensional approach. Starting annotated cell populations either automated clustering FlowSOM traditional cell gating, primary function HDStIM() follows heuristic approach label cells responding non-responding. combination cell population stimulation type (e.g., CD127+ T-helper cells interferon-alpha), HDStIM() starts performing k-means clustering combined set cells stimulated unstimulated samples. K-means clustering performed expression data state markers combined. Upon clustering using contingency table, Fisher’s exact test determines effect size statistical significance partitioning. Cells form combinations pass Fisher’s exact test labelled responding.","code":""},{"path":"https://niaid.github.io/HDStIM/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"High Dimensional Stimulation Immune Mapping (HDStIM)","text":"can install released version stimcellselector CRAN : development version GitHub :","code":"install.packages(\"HDStIM\") # install.packages(\"devtools\") devtools::install_github(\"niaid/HDStIM\")"},{"path":"https://niaid.github.io/HDStIM/index.html","id":"contact","dir":"","previous_headings":"","what":"Contact","title":"High Dimensional Stimulation Immune Mapping (HDStIM)","text":"Rohit Farmer: rohit.farmer@nih.gov, rohit.farmer@gmail.com","code":""},{"path":"https://niaid.github.io/HDStIM/reference/HDStIM.html","id":null,"dir":"Reference","previous_headings":"","what":"HDStIM: High Dimensional Stimulation Immune Mapping — HDStIM","title":"HDStIM: High Dimensional Stimulation Immune Mapping — HDStIM","text":"Function select cells stimulated samples likely responded stimulant.","code":""},{"path":"https://niaid.github.io/HDStIM/reference/HDStIM.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"HDStIM: High Dimensional Stimulation Immune Mapping — HDStIM","text":"","code":"HDStIM(   dat,   state_markers,   cellpop_col,   stim_lab,   unstim_lab,   seed_val = NULL,   umap = FALSE,   umap_cells = NULL,   verbose = FALSE )"},{"path":"https://niaid.github.io/HDStIM/reference/HDStIM.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"HDStIM: High Dimensional Stimulation Immune Mapping — HDStIM","text":"dat tibble single cell data. Cells rows variables/markers columns. state_markers character vector labels state markers stimulation panel. cellpop_col Column tibble cell population IDs. stim_lab character vector stim label(s). unstim_lab character unstim label(s). seed_val Seed value (integer) kmeans clustering. Default NULL seed value. umap Boolean (T/F) carry UMAP selected cells. Default FALSE skip UMAP calculation. umap_cells integer; calculating UMAPs take minimum umap_cells per cluster total number cells cluster size smaller umap_cells. Default NULL. verbose Logical. make function verbose. Default FALSE.","code":""},{"path":"https://niaid.github.io/HDStIM/reference/HDStIM.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"HDStIM: High Dimensional Stimulation Immune Mapping — HDStIM","text":"list tibbles expression data selected cells,         data plot stacked bar plots, data plot UMAP plots,         parameters passed function.","code":""},{"path":"https://niaid.github.io/HDStIM/reference/HDStIM.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"HDStIM: High Dimensional Stimulation Immune Mapping — HDStIM","text":"","code":"if (FALSE) { mapped_data <- HDStIM(chi11$expr_data, chi11$state_markers,                   chi11$cluster_col, chi11$stim_label,                   chi11$unstim_label, seed_val = 123, umap = FALSE, umap_cells = NULL,                   verbose = FALSE) }"},{"path":"https://niaid.github.io/HDStIM/reference/chi11.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample data set for CyTOF Stimulation Assay — chi11","title":"Sample data set for CyTOF Stimulation Assay — chi11","text":"list CyTOF stimulation assay data.","code":""},{"path":"https://niaid.github.io/HDStIM/reference/chi11.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample data set for CyTOF Stimulation Assay — chi11","text":"","code":"chi11"},{"path":"https://niaid.github.io/HDStIM/reference/chi11.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Sample data set for CyTOF Stimulation Assay — chi11","text":"list one tibble containig CyTOF expression data.         four character vectors arguments HDStIM function. chi11$expr_data 7,000 X 36 tibble. Cells rows                          variables columns. first 6 columns contain                          cell cluster_id (FlowSOM clustering),                          sample_id (unique FSC file),                          condition (comparison groups), patient_id (unique subject),                          stim_type (labels types stimulation assays including unstim),                          merging1 (meta culster labels ConsensusClusterPlus).                          last 30 columns contain archsinh transformed CyTOF expression                          values 30 markers (20 type 10 state) used sitmulation panel. chi11$type_markers character vector labels type markers used stimulation panel. chi11$state_markers character vector labels state markers used stimulation panel. chi11$cluster_col character label meta-cluster/cluster ID column chi11$expr_dat tibble. chi11$stim_label character vector label(s) stimulation types corresponding                            labels thestim_type column chi11$expr_data. chi11$unstim_label character label unstim cells corresponding                            labels thestim_type column chi11$expr_data.","code":""},{"path":"https://niaid.github.io/HDStIM/reference/marker_ranking_boruta.html","id":null,"dir":"Reference","previous_headings":"","what":"Marker Ranking by Boruta — marker_ranking_boruta","title":"Marker Ranking by Boruta — marker_ranking_boruta","text":"Function run Boruta stimulation - cell population combinations passed Fisher's exact test rank markers according contribution response.","code":""},{"path":"https://niaid.github.io/HDStIM/reference/marker_ranking_boruta.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Marker Ranking by Boruta — marker_ranking_boruta","text":"","code":"marker_ranking_boruta(   mapped_data,   path = NULL,   n_cells = NULL,   max_runs = 100,   seed_val = 123,   verbose = 0 )"},{"path":"https://niaid.github.io/HDStIM/reference/marker_ranking_boruta.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Marker Ranking by Boruta — marker_ranking_boruta","text":"mapped_data Returned list HDStIM function. path Path folder save figures generated function. n_cells Number cells sample data. Default NULL include cells. max_runs Maximum number runs random forest algorithm. Default 100. seed_val Seed value Boruta. Default 123. verbose 0, 1, 2. Default 0.","code":""},{"path":"https://niaid.github.io/HDStIM/reference/marker_ranking_boruta.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Marker Ranking by Boruta — marker_ranking_boruta","text":"function generates figures specified path folder                         returns tibble attributes statistics calculated                         Boruta.","code":""},{"path":"https://niaid.github.io/HDStIM/reference/marker_ranking_boruta.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Marker Ranking by Boruta — marker_ranking_boruta","text":"","code":"if (FALSE) { attribute_stats <- marker_ranking_boruta(mapped_data, path = NULL, n_cells = NULL,                                         max_runs = 1000, seed_val = 123,                                         verbose = FALSE) }"},{"path":"https://niaid.github.io/HDStIM/reference/plot_K_Fisher.html","id":null,"dir":"Reference","previous_headings":"","what":"Diagnostic plots explaining K-means clustering and Fisher's exact test carried out by HDStIM — plot_K_Fisher","title":"Diagnostic plots explaining K-means clustering and Fisher's exact test carried out by HDStIM — plot_K_Fisher","text":"Diagnostic plots explaining K-means clustering Fisher's exact test carried HDStIM","code":""},{"path":"https://niaid.github.io/HDStIM/reference/plot_K_Fisher.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Diagnostic plots explaining K-means clustering and Fisher's exact test carried out by HDStIM — plot_K_Fisher","text":"","code":"plot_K_Fisher(mapped_data, path, verbose = FALSE)"},{"path":"https://niaid.github.io/HDStIM/reference/plot_K_Fisher.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Diagnostic plots explaining K-means clustering and Fisher's exact test carried out by HDStIM — plot_K_Fisher","text":"mapped_data Returned list HDStIM function. path Path folder save figures generated function. verbose Logical. make function verbose. Default FALSE.","code":""},{"path":"https://niaid.github.io/HDStIM/reference/plot_K_Fisher.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Diagnostic plots explaining K-means clustering and Fisher's exact test carried out by HDStIM — plot_K_Fisher","text":"function generates figures specified path folder returns 0.","code":""},{"path":"https://niaid.github.io/HDStIM/reference/plot_K_Fisher.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Diagnostic plots explaining K-means clustering and Fisher's exact test carried out by HDStIM — plot_K_Fisher","text":"","code":"if (FALSE) { plot_K_Fisher(mapped_data, path, verbose = FALSE) }"},{"path":"https://niaid.github.io/HDStIM/reference/plot_exprs.html","id":null,"dir":"Reference","previous_headings":"","what":"Diagnostic plots showing individual marker distribution before and after mapping by HDStIM — plot_exprs","title":"Diagnostic plots showing individual marker distribution before and after mapping by HDStIM — plot_exprs","text":"Diagnostic plots showing individual marker distribution mapping HDStIM","code":""},{"path":"https://niaid.github.io/HDStIM/reference/plot_exprs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Diagnostic plots showing individual marker distribution before and after mapping by HDStIM — plot_exprs","text":"","code":"plot_exprs(mapped_data, path, verbose = FALSE)"},{"path":"https://niaid.github.io/HDStIM/reference/plot_exprs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Diagnostic plots showing individual marker distribution before and after mapping by HDStIM — plot_exprs","text":"mapped_data List output HDStIM function. path Path folder save figures generated function. verbose Logical. make function verbose. Default FALSE.","code":""},{"path":"https://niaid.github.io/HDStIM/reference/plot_exprs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Diagnostic plots showing individual marker distribution before and after mapping by HDStIM — plot_exprs","text":"function generates plots specified folder returns 0 upon successful completion.","code":""},{"path":"https://niaid.github.io/HDStIM/reference/plot_exprs.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Diagnostic plots showing individual marker distribution before and after mapping by HDStIM — plot_exprs","text":"","code":"if (FALSE) { plot_exprs(mapped_data, path, verbose = FALSE) }"},{"path":"https://niaid.github.io/HDStIM/reference/plot_umap.html","id":null,"dir":"Reference","previous_headings":"","what":"Diagnostic UMAP plots showing the partitioning of cells into responding and non-responding groups by HDStIM — plot_umap","title":"Diagnostic UMAP plots showing the partitioning of cells into responding and non-responding groups by HDStIM — plot_umap","text":"Diagnostic UMAP plots showing partitioning cells responding non-responding groups HDStIM","code":""},{"path":"https://niaid.github.io/HDStIM/reference/plot_umap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Diagnostic UMAP plots showing the partitioning of cells into responding and non-responding groups by HDStIM — plot_umap","text":"","code":"plot_umap(mapped_data, path, verbose = FALSE)"},{"path":"https://niaid.github.io/HDStIM/reference/plot_umap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Diagnostic UMAP plots showing the partitioning of cells into responding and non-responding groups by HDStIM — plot_umap","text":"mapped_data Returned list HDStIM function. path Path folder save figures generated function. verbose Logical. make function verbose. Default FALSE.","code":""},{"path":"https://niaid.github.io/HDStIM/reference/plot_umap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Diagnostic UMAP plots showing the partitioning of cells into responding and non-responding groups by HDStIM — plot_umap","text":"function generates figures specified path folder returns 0.","code":""},{"path":"https://niaid.github.io/HDStIM/reference/plot_umap.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Diagnostic UMAP plots showing the partitioning of cells into responding and non-responding groups by HDStIM — plot_umap","text":"","code":"if (FALSE) { plot_umap(mapped_data, path, verbose = FALSE) }"}]
